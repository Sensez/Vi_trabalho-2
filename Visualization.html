<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <style type="text/css">
      .axis path{
        fill:none;
        stroke: black;
      }
      .axis {
        font-size:8pt;
        font-family:sans-serif;
      }
      .tick {
        fill:none;
        stroke:black;
      }
    </style>
    <script src="d3/d3.js"></script>
  </head>
  <body>
    <script>

      var dates = [];
      var years = [];
      var occurencesPerYear = [];
      var newDataSet = [];

      var margin = 40;
      var width = 800;
      var height = 600;

      d3.csv("complete.csv", function(error, data) {
        if (error) throw error;

        data.forEach(function(d) {
          dates.push(d.datetime);
        });

        dates.forEach(function(entry) {
          var year = entry.split("/")[2].split(" ")[0];

          if(years.indexOf(year) == -1)
            years.push(year);

          if(occurencesPerYear[year] != null)
            occurencesPerYear[year] += 1;
          else
            occurencesPerYear[year] = 1;
        });

        years.sort().forEach(function(year) {
            var obj = new Object;
            obj["year"] = year;
            obj["Sightings"] = occurencesPerYear[year];
            newDataSet.push(obj);
        });

        var maxSightings = 0;
        newDataSet.forEach(function(data){
          if(data.Sightings > maxSightings)
            maxSightings = data.Sightings;
        });

        var y_extent = [0,maxSightings];
        var y_scale = d3.scaleLinear().range([height - margin, margin]).domain(y_extent);
        var x_extent = [newDataSet[0].year, newDataSet[newDataSet.length-1].year];
        var x_scale = d3.scaleLinear().range([margin, width - margin]).domain(x_extent);
        var x_axis = d3.axisBottom(x_scale);
        var y_axis = d3.axisLeft(y_scale).ticks(maxSightings/500);

        var svg = d3.select("body")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .style("background", "white");

        d3.select("svg").append("g").attr("class", "x axis").attr("transform", "translate(0," + (height - margin) + ")").call(x_axis);
        d3.select("svg").append("g").attr("class", "y axis").attr("transform", "translate(" +  margin + ",0)").call(y_axis);
    });
    </script>
  </body>
</html>
